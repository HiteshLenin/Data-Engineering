#1. Get all customers whose first name starts with 'J' and who are active

select first_name, active
from customer
Where first_name Like '%J' 
  and active = 1;
  
#2. Find all films where the title contains the word 'ACTION' or the description contains 'WAR'.
select title, description
from film
Where title LIKE '%ACTION%' or description LIKE '%WAR%'; 

#3. List all customers whose last name is not 'SMITH' and whose first name ends with 'a'.

select last_name, first_name 
from customer
Where last_name != 'SMITH' 
 AND first_name LIKE '%a';
 
 #4. Get all films where the rental rate is greater than 3.0 and the replacement cost is not null.
 
 select title, rental_rate, replacement_cost
 from film
 where rental_rate > '3.0'
 AND replacement_cost IS NOT NULL;
 
 #5. Count how many customers exist in each store who have active status = 1.
select store_id, count(*) as active_customer
from customer
Where Active = '1'
group by store_id;

#6. Show distinct film ratings available in the film table.
 
SELECT DISTINCT rating
FROM film;

#7. Find the number of films for each rental duration where the average length is more than 100 minutes.

select rental_duration, count(*) as total_films
from film
group by rental_duration
Having AVG(length) > 100; 

#8. List payment dates and total amount paid per date, but only include days where more than 100 payments were made.
select payment_date, sum(amount) as total_amount_perday
from payment
Group by payment_date
Having sum(amount) >100;

#9. Find customers whose email address is null or ends with '.org'.

select customer_id, email
from customer
where email IS NULL
or email like '%.org';

#10. List all films with rating 'PG' or 'G', and order them by rental rate in descending order.

select title, rating, rental_rate
from film
where rating = 'PG' or  rating = 'G'
Order by rental_rate Desc;

#11. Count how many films exist for each length where the film title starts with 'T' and the count is more than 5.

select length, Count(*) as film_count 
from film
Where title Like 'T%'
Group by length
Having count(*) > 5;

#12. List all actors who have appeared in more than 10 films.
select actor_id, count(*) as actor
from film_actor
Group by actor_id
Having count(*) >10;

#13. Find the top 5 films with the highest rental rates and longest lengths combined, ordering by rental rate first and length second.

select title, rental_rate, length
from film
Order by rental_rate DESC, length DESC
LIMIT 5 ;

#14. Show all customers along with the total number of rentals they have made, ordered from most to least rentals.

select c.customer_id, c.first_name, c.last_name, c.email, count(r.rental_id) as total_rentals
from customer c
left join rental r on c.customer_id = r.customer_id	
Group by c.customer_id, c.first_name, c.last_name, c.email
Order by total_rentals Desc;

#15. List the film titles that have never been rented.

select f.title
from film f
join inventory i on f.film_id = i.film_id
left join rental r on i.inventory_id = r.inventory_id
where r.rental_id IS NULL;
