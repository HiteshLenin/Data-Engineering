# 1. Identify if there are duplicates in Customer table. Don't use customer id to check the duplicates
use sakila;
show tables;
select * from customer;
select first_name, last_name, email, count(*) as duplicate_customer
from customer
group by first_name, last_name, email
Having count(*) > 1;

# 2. Number of times letter 'a' is repeated in film descriptions
SELECT
  description,
  LENGTH(LOWER(description)) 
  - LENGTH(REPLACE(LOWER(description), 'a', '')) AS a_count
FROM film;

# 3. Number of times each vowel is repeated in film descriptions 

SELECT
  description,
  LENGTH(LOWER(description)) 
  - LENGTH(REPLACE(LOWER(description), 'a', '')) AS a_count,
  LENGTH(LOWER(description)) 
  - LENGTH(REPLACE(LOWER(description), 'e', '')) AS e_count,
  LENGTH(LOWER(description)) 
  - LENGTH(REPLACE(LOWER(description), 'i', '')) AS i_count,
  LENGTH(LOWER(description)) 
  - LENGTH(REPLACE(LOWER(description), 'o', '')) AS o_count,
  LENGTH(LOWER(description)) 
  - LENGTH(REPLACE(LOWER(description), 'u', '')) AS u_count
FROM film;

#4. Display the payments made by each customer
        1. Month wise
        2. Year wise
        3. Week wise
   
select customer_id,Year(payment_date) as year, Month(payment_date) as month, Day(payment_date) as day, count(amount) as total_paymnets
from payment
Group by customer_id, Year(payment_date), Month(payment_date), Day(payment_date)
Order by customer_id, year, month DESC;        
        
# 5.Check if any given year is a leap year or not. You need not consider any table from sakila database. Write within the select query with hardcoded date



#6. Display number of days remaining in the current year from today.
select Now(), Datediff('2026-12-31', curdate());


#7. Display quarter number(Q1,Q2,Q3,Q4) for the payment dates from payment table. 
select * from payment;
select payment_id, customer_id, payment_date,
     CASE 
       when payment_date >= '2005-01-01' AND payment_date < '2005-04-01' then 'Q1'
	   when payment_date >= '2005-04-01' AND payment_date < '2005-07-01' then 'Q2'
	   when payment_date >= '2005-07-01' AND payment_date < '2005-10-01' then 'Q3'
       Else 'Q4'
     END AS quarter_2005
 From payment;
 
# 8. Display the age in year, months, days based on your date of birth. 
   #For example: 21 years, 4 months, 12 days  
