#Joins
#1. List all customers along with the films they have rented 

use sakila;
select * from customer;
select * from film;
select * from rental;
select * from inventory;
select c. customer_id, f.title, f.film_id
from customer c
join rental r on r.customer_id = c.customer_id 
join inventory i on i.inventory_id = r.inventory_id
join film f on f.film_id = i.film_id
order by customer_id, f.title;
            
         
# 2. List all customers and show their rental count, including those who haven't rented any films.
select * from payment;
select * from customer;
select * from rental; 
select c.customer_id, c.first_name, count(rental_id) as total_rentals
from customer c
Left join rental r on r.customer_id = c.customer_id
Group by c.customer_id, c.first_name;

#3. Show all films along with their category. Include films that don't have a category assigned.
select * from film;
select * from category;
select * from film_category;

select f.film_id, f.title, c.category_id, c.name as category_name
from film f
Left Join film_category fc on fc.film_id = f.film_id
Left Join category c on  c.category_id = fc.category_id
Order by f.film_id;

#4. Show all customers and staff emails from both customer and staff tables using a full outer join (simulate using LEFT + RIGHT + UNION).
select * from customer;
select * from payment;
select * from staff;
SELECT c.customer_id, c.first_name, c.last_name, c.email AS customer_email, s.staff_id, s.email AS staff_email
FROM customer c
LEFT JOIN staff s ON c.email = s.email

UNION

SELECT c.customer_id, c.first_name, c.last_name, c.email AS customer_email, s.staff_id, s.email AS staff_email
FROM customer c
RIGHT JOIN staff s ON c.email = s.email;

#5. Find all actors who acted in the film "ACADEMY DINOSAUR".

select * from actor;
select * from film;
select * from film_actor;

select a.actor_id, a.first_name, a.last_name
from actor a
join film_actor fa on fa.actor_id = a.actor_id
join film f on f.film_id = fa.film_id
where f.title = "ACADEMY DINOSAUR" ;



#7. List the customers who have rented films more than 5 times. Include their name and total rental count.


